{{- $agent_ephemeral_id := generate "agent_ephemeral_id" }}
{{- $agent_id := generate "agent_id" }}
{{- $agent_name := generate "agent_name" }}
{{- $deployment_name := generate "deployment_name" }}
{{- $event_count := generate "event_count" }}
{{- $event_duration := generate "event_duration" }}
{{- $event_timestamp_first_occurrence := generate "event_timestamp_first_occurrence" }}
{{- $event_timestamp_last_occurrence := generate "event_timestamp_last_occurrence" }}
{{- $host_id := generate "host_id" }}
{{- $host_ip := generate "host_ip" }}
{{- $hostname := generate "hostname" }}
{{- $involved_object_api_version := generate "involved_object_api_version" }}
{{- $involved_object_kind := generate "involved_object_kind" }}
{{- $involved_object_name := generate "involved_object_name" }}
{{- $involved_object_resource_version := generate "involved_object_resource_version" }}
{{- $involved_object_uid := generate "involved_object_uid" }}
{{- $message := generate "message" }}
{{- $metadata_generate_name := generate "metadata_generate_name" }}
{{- $metadata_name := generate "metadata_name" }}
{{- $metadata_namespace := generate "metadata_namespace" }}
{{- $metadata_resource_version := generate "metadata_resource_version" }}
{{- $metadata_self_link := generate "metadata_self_link" }}   
{{- $metadata_timestamp_created := generate "metadata_timestamp_created" }}
{{- $metadata_uid := generate "metadata_uid" }}
{{- $node_hostname := generate "node_hostname" }}
{{- $node_name := generate "node_name" }}
{{- $orchestrator_cluster_name := generate "orchestrator_cluster_name" }}
{{- $orchestrator_cluster_url := generate "orchestrator_cluster_url" }}
{{- $pod_ip := generate "pod_ip" }}
{{- $pod_name := generate "pod_name" }}
{{- $pod_uid := generate "pod_uid" }}
{{- $reason := generate "reason" }}
{{- $replicaset_name := generate "replicaset_name" }}
{{- $service_address := generate "service_address" }}
{{- $source_component := generate "source_component" }}
{{- $source_host := generate "source_host" }}
{{- $timestamp := generate "timestamp" }}
{{- $type := generate "type" }}
{
    "@timestamp": "{{$timestamp.Format "2006-01-02T15:04:05.999999Z07:00"}}",
    "metricset": {
        "name": "event"
    },
    "agent": {
        "type": "metricbeat",
        "version": "8.8.0",
        "ephemeral_id": "{{ $agent_ephemeral_id }}",
        "id": "{{ $agent_id }}",
        "name": "{{ $agent_name }}"
    },
    "ecs": {
        "version": "1.5.0"
    },
    "event": {
        "dataset": "kubernetes.event",
        "module": "kubernetes"
    },
    "service": {
        "address": "{{ $service_address }}",
        "type": "kubernetes"
    },
    "orchestrator": {
        "cluster": {
            "name": "{{ $orchestrator_cluster_name }}",
            "url": "{{ $orchestrator_cluster_url }}"
        }
    },
    "kubernetes": {
        "event": {
            "metadata": {
                "uid": "{{ $metadata_uid }}",
                "resource_version": "{{ $metadata_resource_version }}",
                "timestamp": {
                    "created": "{{$metadata_timestamp_created.Format "2006-01-02T15:04:05.999999Z07:00"}}"
                },
                "name": "{{ $metadata_name }}",
                "namespace": "{{ $metadata_namespace }}",
                "self_link": "{{ $metadata_self_link }}",
                "generate_name": "{{ $metadata_generate_name }}"
            },
            "timestamp": {
                "first_occurrence": "{{$event_timestamp_first_occurrence.Format "2006-01-02T15:04:05.999999Z07:00"}}",
                "last_occurrence": "{{$event_timestamp_last_occurrence.Format "2006-01-02T15:04:05.999999Z07:00"}}"
            },
            "message": "{{ $message }}",
            "reason": "{{ $reason }}",
            "type": "{{ $type }}",
            "count": {{ $event_count }},
            "source": {
                "host": "{{ $source_host }}",
                "component": "{{ $source_component }}"
            },
            "involved_object": {
                "api_version": "{{ $involved_object_api_version }}",
                "resource_version": "{{ $involved_object_resource_version }}",
                "name": "{{ $involved_object_name }}",
                "kind": "{{ $involved_object_kind }}",
                "uid": "{{ $involved_object_uid }}"
            }
        },
        "pod":{
         "uid": "{{ $pod_uid }}",
         "ip": "{{generate "pod_ip"}}",
         "name": "{{ $pod_name }}",
         "replicaset":{
            "name": "{{ $replicaset_name }}"
         },
         "deployment":{
            "name": "{{ $deployment_name }}"
         }
      }        
    },
    "host": {
        "id": "{{ $host_id }}",
        "containerized": false,
        "node_hostname": "{{ $node_hostname }}",
        "ip": [
            "{{ $host_ip }}"
        ],
        "mac": [
            "02:42:ac:11:00:0b"
        ],
        "hostname": "{{ $hostname }}",
        "name": "{{ $hostname }}",
        "architecture": "x86_64",
        "os": {
            "platform": "centos",
            "version": "7 (Core)",
            "family": "redhat",
            "name": "CentOS Linux",
            "kernel": "4.19.81",
            "codename": "Core"
        }
    }
}