{{- $timestamp := generate "timestamp" }}
{{- $event_count := generate "event_count" }}
{{- $event_duration := generate "event_duration" }}
{{- $duration_start := generate "duration_start" }}
{{- $duration_end := generate "duration_end" }}
{{- $first_occurrence := generate "timestamp" | date_modify (print $duration_start) }}
{{- $last_occurrence := generate "timestamp" | date_modify (print $duration_end) }}
{{- $involved_object_api_version := generate "involved_object_api_version" }}
{{- $involved_object_kind := generate "involved_object_kind" }}
{{- $involved_object_name := generate "involved_object_name" }}
{{- $involved_object_resource_version := generate "involved_object_resource_version" }}
{{- $involved_object_uid := generate "involved_object_uid" }}
{{- $message := generate "message" }}
{{- $metadata_generate_name := generate "metadata_generate_name" }}
{{- $metadata_name := generate "metadata_name" }}
{{- $metadata_resource_version := generate "metadata_resource_version" }}
{{- $metadata_uid := generate "metadata_uid" }}
{{- $reason := generate "reason" }}
{{- $source_component := generate "source_component" }}
{{- $source_host := generate "source_host" }}
{{- $type := generate "type" }}
{
    "@timestamp": "{{$timestamp.Format "2006-01-02T15:04:05.000Z07:00"}}",
    "metricset": {
        "name": "event"
    },
    "agent": {
        "type": "metricbeat",
        "version": "8.8.0",
        "ephemeral_id": "22ed892c-43bd-408a-9121-65e2f5b6a56e",
        "id": "de42127b-4db8-4471-824e-a7b14f478663",
        "name": "kubernetes-scale-123456"
    },
     "elastic_agent": {
        "id": "de42127b-4db8-4471-824e-a7b14f478663",
        "version": "8.8.0",
        "snapshot": true
    },
    "ecs": {
        "version": "8.5.0"
    },
    "event": {
        "duration": {{ $event_duration }},
        "dataset": "kubernetes.event",
        "module": "kubernetes"
    },
    "service": {
        "type": "kubernetes"
    },
    "orchestrator":{
        "cluster":{
        "name":"kubernetes-scale",
        "url":"https://{{ generate `Ip` }}"
        }
    },
    "kubernetes": {
        "event": {
            "metadata": {
                "uid": "{{ $metadata_uid }}",
                "resource_version": "{{ $metadata_resource_version }}",
                "timestamp": {
                    "created": "{{ $first_occurrence.Format "2006-01-02T15:04:05.000Z07:00" }}"
                },
                "name": "monitor.{{ $metadata_name }}",
                "namespace": "beats",
                "self_link": "/api/v1/namespaces/beats/events/monitor.{{ $metadata_name }}",
                "generate_name": "{{ $metadata_generate_name }}"
            },
            "timestamp": {
                "first_occurrence": "{{ $first_occurrence.Format "2006-01-02T15:04:05.000Z07:00" }}",
                "last_occurrence": "{{ $last_occurrence.Format "2006-01-02T15:04:05.000Z07:00" }}"
            },
            "message": "{{ $message }}",
            "reason": "{{ $reason }}",
            "type": "{{ $type }}",
            "count": {{ $event_count }},
            "source": {
                "host": "{{ $source_host }}",
                "component": "{{ $source_component }}"
            },
            "involved_object": {
                "api_version": "{{ $involved_object_api_version }}",
                "resource_version": "{{ $involved_object_resource_version }}",
                "name": "{{ $involved_object_name }}",
                "kind": "{{ $involved_object_kind }}",
                "uid": "{{ $involved_object_uid }}"
            }
        }    
    },
    "host": {
        "hostname": "kubernetes-scale-123456",
        "os": {
            "kernel": "5.10.47-linuxkit",
            "codename": "Core",
            "name": "CentOS Linux",
            "type": "linux",
            "family": "redhat",
            "version": "7 (Core)",
            "platform": "centos"
        },
        "containerized": true,
        "name": "kubernetes-scale-123456",
        "id": "85e35c2b5e1b39ba72393a6baf6ee7cd",
        "architecture": "x86_64"
    }
}